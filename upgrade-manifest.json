{
    "modules": [
        {
            "name": "Az.Accounts",
            "url": "https://www.powershellgallery.com/api/v2/package/Az.Accounts/2.7.0"
        },
        {
            "name": "Microsoft.Graph.Authentication",
            "url": "https://www.powershellgallery.com/api/v2/package/Microsoft.Graph.Authentication/1.9.0"
        },
        {
            "name": "Az.Advisor",
            "url": "https://www.powershellgallery.com/api/v2/package/Az.Advisor/1.1.2"
        },
        {
            "name": "Az.Compute",
            "url": "https://www.powershellgallery.com/api/v2/package/Az.Compute/4.21.0"
        },
        {
            "name": "Az.OperationalInsights",
            "url": "https://www.powershellgallery.com/api/v2/package/Az.OperationalInsights/3.0.0"
        },
        {
            "name": "Az.ResourceGraph",
            "url": "https://www.powershellgallery.com/api/v2/package/Az.ResourceGraph/0.11.0"
        },
        {
            "name": "Az.Storage",
            "url": "https://www.powershellgallery.com/api/v2/package/Az.Storage/4.1.0"
        },
        {
            "name": "Az.Resources",
            "url": "https://www.powershellgallery.com/api/v2/package/Az.Resources/5.1.0"
        },
        {
            "name": "Az.Monitor",
            "url": "https://www.powershellgallery.com/api/v2/package/Az.Monitor/3.0.0"
        },
        {
            "name": "Microsoft.Graph.Users",
            "url": "https://www.powershellgallery.com/api/v2/package/Microsoft.Graph.Users/1.9.0"
        },
        {
            "name": "Microsoft.Graph.Groups",
            "url": "https://www.powershellgallery.com/api/v2/package/Microsoft.Graph.Groups/1.9.0"
        },
        {
            "name": "Microsoft.Graph.Applications",
            "url": "https://www.powershellgallery.com/api/v2/package/Microsoft.Graph.Applications/1.9.0"
        },
        {
            "name": "Microsoft.Graph.Identity.DirectoryManagement",
            "url": "https://www.powershellgallery.com/api/v2/package/Microsoft.Graph.Identity.DirectoryManagement/1.9.0"
        }
    ],
    "schedules": [
        {
            "name": "AzureOptimization_ExportAADObjectsDaily",
            "offset": "PT1H",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestAADObjectsDaily",
            "offset": "PT2H",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_ExportAdvisorWeekly",
            "offset": "PT1H15M",
            "frequency": "Week"
        },
        {
            "name": "AzureOptimization_IngestAdvisorWeekly",
            "offset": "PT1H45M",
            "frequency": "Week"
        },
        {
            "name": "AzureOptimization_ExportARGDaily",
            "offset": "PT1H",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGAppGWsDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGAvailSetsDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGLoadBalancersDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGDisksDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGPublicIPsDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGNICsDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGNSGsDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGVNetsDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGVHDsDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGVMsDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGVMSSDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestARGResourceContainersDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_ExportConsumptionDaily",
            "offset": "PT1H",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestConsumptionDaily",
            "offset": "PT2H",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_ExportRBACDaily",
            "offset": "PT1H",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_IngestRBACDaily",
            "offset": "PT2H",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_RecommendationsWeekly",
            "offset": "PT2H30M",
            "frequency": "Week"
        },
        {
            "name": "AzureOptimization_IngestRecommendationsWeekly",
            "offset": "PT3H30M",
            "frequency": "Week"
        },
        {
            "name": "AzureOptimization_IngestRemediationLogsDaily",
            "offset": "PT1H30M",
            "frequency": "Day"
        },
        {
            "name": "AzureOptimization_ExportMonitorVmssCpuMaxHourly",
            "offset": "PT1H15M",
            "frequency": "Hour"
        },
        {
            "name": "AzureOptimization_ExportMonitorVmssCpuAvgHourly",
            "offset": "PT1H15M",
            "frequency": "Hour"
        },
        {
            "name": "AzureOptimization_ExportMonitorVmssMemoryMinHourly",
            "offset": "PT1H15M",
            "frequency": "Hour"
        },
        {
            "name": "AzureOptimization_IngestAzMonitorMetricsHourly",
            "offset": "PT2H",
            "frequency": "Hour"
        }
    ],
    "baseIngest": [
        {
            "runbook": "runbooks/data-collection/Ingest-OptimizationCSVExportsToLogAnalytics.ps1",
            "source": "dataCollection"
        },
        {
            "runbook": "runbooks/recommendations/Ingest-RecommendationsToSQLServer.ps1",
            "source": "recommendations"
        }
    ],
    "dataCollection": [
        {
            "runbook": "runbooks/data-collection/Export-AADObjectsToBlobStorage.ps1",
            "container": "aadobjectsexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportAADObjectsDaily",
            "ingestSchedule": "AzureOptimization_IngestAADObjectsDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGAppGatewayPropertiesToBlobStorage.ps1",
            "container": "argappgwexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGAppGWsDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGAvailabilitySetPropertiesToBlobStorage.ps1",
            "container": "argavailsetexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGAvailSetsDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGLoadBalancerPropertiesToBlobStorage.ps1",
            "container": "arglbexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGLoadBalancersDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGManagedDisksPropertiesToBlobStorage.ps1",
            "container": "argdiskexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGDisksDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGNICPropertiesToBlobStorage.ps1",
            "container": "argnicexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGNICsDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGNSGPropertiesToBlobStorage.ps1",
            "container": "argnsgexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGNSGsDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGPublicIpPropertiesToBlobStorage.ps1",
            "container": "argpublicipexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGPublicIPsDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGResourceContainersPropertiesToBlobStorage.ps1",
            "container": "argrescontainersexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGResourceContainersDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGUnmanagedDisksPropertiesToBlobStorage.ps1",
            "container": "argvhdexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGVHDsDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGVNetPropertiesToBlobStorage.ps1",
            "container": "argvnetexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGVNetsDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGVirtualMachinesPropertiesToBlobStorage.ps1",
            "container": "argvmexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGVMsDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-ARGVMSSPropertiesToBlobStorage.ps1",
            "container": "argvmssexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportARGDaily",
            "ingestSchedule": "AzureOptimization_IngestARGVMSSDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-AdvisorRecommendationsToBlobStorage.ps1",
            "container": "advisorexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportAdvisorWeekly",
            "ingestSchedule": "AzureOptimization_IngestAdvisorWeekly"
        },
        {
            "runbook": "runbooks/data-collection/Export-ConsumptionToBlobStorage.ps1",
            "container": "consumptionexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportConsumptionDaily",
            "ingestSchedule": "AzureOptimization_IngestConsumptionDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-RBACAssignmentsToBlobStorage.ps1",
            "container": "rbacexports",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_ExportRBACDaily",
            "ingestSchedule": "AzureOptimization_IngestRBACDaily"
        },
        {
            "runbook": "runbooks/data-collection/Export-AzMonitorMetricsToBlobStorage.ps1",
            "container": "azmonitorexports",
            "requiredVariables": [
            ],
            "exportSchedules": [
                {
                    "schedule": "AzureOptimization_ExportMonitorVmssCpuMaxHourly",
                    "parameters": {
                        "ResourceType": "microsoft.compute/virtualmachinescalesets",
                        "TimeSpan": "01:00:00",
                        "aggregationType": "Maximum",
                        "MetricNames": "Percentage CPU",
                        "TimeGrain": "01:00:00"
                    }
                },
                {
                    "schedule": "AzureOptimization_ExportMonitorVmssCpuAvgHourly",
                    "parameters": {
                        "ResourceType": "microsoft.compute/virtualmachinescalesets",
                        "TimeSpan": "01:00:00",
                        "aggregationType": "Average",
                        "MetricNames": "Percentage CPU",
                        "TimeGrain": "01:00:00"
                    }
                },
                {
                    "schedule": "AzureOptimization_ExportMonitorVmssMemoryMinHourly",
                    "parameters": {
                        "ResourceType": "microsoft.compute/virtualmachinescalesets",
                        "TimeSpan": "01:00:00",
                        "aggregationType": "Minimum",
                        "MetricNames": "Available Memory Bytes",
                        "TimeGrain": "01:00:00"
                    }
                }
            ],
            "ingestSchedule": "AzureOptimization_IngestAzMonitorMetricsHourly"
        }
    ],
    "recommendations": [
        {
            "runbook": "runbooks/recommendations/Recommend-AADExpiringCredentialsToBlobStorage.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_RecommendationAADMinCredValidityDays",
                    "defaultValue": 30
                },
                {
                    "name": "AzureOptimization_RecommendationAADMaxCredValidityYears",
                    "defaultValue": 2
                }
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        },
        {
            "runbook": "runbooks/recommendations/Recommend-AdvisorAsIsToBlobStorage.ps1",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        },
        {
            "runbook": "runbooks/recommendations/Recommend-AdvisorCostAugmentedToBlobStorage.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_ConsumptionOffsetDays",
                    "defaultValue": 3
                }
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        },
        {
            "runbook": "runbooks/recommendations/Recommend-LongDeallocatedVmsToBlobStorage.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_RecommendationLongDeallocatedVmsIntervalDays",
                    "defaultValue": 30
                },
                {
                    "name": "AzureOptimization_ConsumptionOffsetDays",
                    "defaultValue": 3
                }
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        },
        {
            "runbook": "runbooks/recommendations/Recommend-UnattachedDisksToBlobStorage.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_ConsumptionOffsetDays",
                    "defaultValue": 3
                }
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        },
        {
            "runbook": "runbooks/recommendations/Recommend-UnusedAppGWsToBlobStorage.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_ConsumptionOffsetDays",
                    "defaultValue": 3
                }
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        },
        {
            "runbook": "runbooks/recommendations/Recommend-UnusedLoadBalancersToBlobStorage.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_ConsumptionOffsetDays",
                    "defaultValue": 3
                }
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        },
        {
            "runbook": "runbooks/recommendations/Recommend-VMsHighAvailabilityToBlobStorage.ps1",
            "requiredVariables": [
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        },
        {
            "runbook": "runbooks/recommendations/Recommend-ARMOptimizationsToBlobStorage.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_RecommendationRBACAssignmentsPercentageThreshold",
                    "defaultValue": 80
                },
                {
                    "name": "AzureOptimization_RecommendationResourceGroupsPerSubPercentageThreshold",
                    "defaultValue": 80
                }
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        },
        {
            "runbook": "runbooks/recommendations/Recommend-VNetOptimizationsToBlobStorage.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_RecommendationVNetSubnetMaxUsedPercentageThreshold",
                    "defaultValue": 80
                },
                {
                    "name": "AzureOptimization_RecommendationVNetSubnetMinUsedPercentageThreshold",
                    "defaultValue": 5
                },
                {
                    "name": "AzureOptimization_RecommendationVNetSubnetEmptyMinAgeInDays",
                    "defaultValue": 30
                }
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        },
        {
            "runbook": "runbooks/recommendations/Recommend-VMSSOptimizationsToBlobStorage.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_PerfThresholdCpuDegradedMaxPercentage",
                    "defaultValue": 95
                },
                {
                    "name": "AzureOptimization_PerfThresholdCpuDegradedAvgPercentage",
                    "defaultValue": 70
                },
                {
                    "name": "AzureOptimization_PerfThresholdMemoryDegradedPercentage",
                    "defaultValue": 80
                }
            ],
            "exportSchedule": "AzureOptimization_RecommendationsWeekly"
        }
    ],
    "remediations": [
        {
            "runbook": "runbooks/remediations/Remediate-AdvisorRightSizeFiltered.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_RemediateRightSizeMinFitScore",
                    "defaultValue": 5.0
                },
                {
                    "name": "AzureOptimization_RemediateRightSizeMinWeeksInARow",
                    "defaultValue": 4
                }
            ]
        },
        {
            "runbook": "runbooks/remediations/Remediate-LongDeallocatedVMsFiltered.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_RemediateLongDeallocatedVMsMinFitScore",
                    "defaultValue": 5.0
                },
                {
                    "name": "AzureOptimization_RemediateLongDeallocatedVMsMinWeeksInARow",
                    "defaultValue": 4
                }
            ]
        },
        {
            "runbook": "runbooks/remediations/Remediate-UnattachedDisksFiltered.ps1",
            "requiredVariables": [
                {
                    "name": "AzureOptimization_RemediateUnattachedDisksMinFitScore",
                    "defaultValue": 5.0
                },
                {
                    "name": "AzureOptimization_RemediateUnattachedDisksMinWeeksInARow",
                    "defaultValue": 4
                },
                {
                    "name": "AzureOptimization_RemediateUnattachedDisksAction",
                    "defaultValue": "Delete"
                }
            ]
        }
    ],
    "deprecatedRunbooks": [
        "Recommend-AvailSetsWithLowFaultDomainCountToBlobStorage",
        "Recommend-AvailSetsWithLowUpdateDomainCountToBlobStorage",
        "Recommend-AvailSetsWithVMsSharingStorageAccountsToBlobStorage",
        "Recommend-StorageAccountsWithMultipleVMsToBlobStorage",
        "Recommend-VMsNoAvailSetToBlobStorage",
        "Recommend-VMsSingleInAvailSetToBlobStorage",
        "Recommend-VMsWithDisksMultipleStorageAccountsToBlobStorage",
        "Recommend-VMsWithUnmanagedDisksToBlobStorage"
    ]
}